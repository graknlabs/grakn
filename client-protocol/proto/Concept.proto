syntax = "proto3";

option java_package = "ai.grakn.rpc.proto";
option java_outer_classname = "ConceptProto";

import "Iterator.proto";

package session;

message Method {
    message Req {
        oneof req {
            // Concept methods
            Concept.Delete.Req delete = 1;

            // SchemaConcept methods
            IsImplicit.Req isImplicit = 2;
            GetLabel.Req getLabel = 3;
            SetLabel.Req setLabel = 4;
            GetSubConcepts.Req getSubConcepts = 5;
            GetSuperConcepts.Req getSuperConcepts = 6;
            GetDirectSuperConcept.Req getDirectSuperConcept = 7;
            SetDirectSuperConcept.Req setDirectSuperConcept = 8;

            // Rule methods
            GetWhen.Req getWhen = 9;
            GetThen.Req getThen = 10;

            // Role methods
            GetRelationshipTypesThatRelateRole.Req getRelationshipTypesThatRelateRole = 11;
            GetTypesThatPlayRole.Req getTypesThatPlayRole = 12;

            // Type methods
            IsAbstract.Req isAbstract = 13;
            SetAbstract.Req setAbstract = 14;
            GetInstances.Req getInstances = 15;
            GetAttributeTypes.Req getAttributeTypes = 16;
            GetKeyTypes.Req getKeyTypes = 17;
            GetRolesPlayedByType.Req getRolesPlayedByType = 18;
            SetAttributeType.Req setAttributeType = 19;
            UnsetAttributeType.Req unsetAttributeType = 20;
            SetKeyType.Req setKeyType = 21;
            UnsetKeyType.Req unsetKeyType = 22;
            SetRolePlayedByType.Req setRolePlayedByType = 23;
            UnsetRolePlayedByType.Req unsetRolePlayedByType = 24;

            // EntityType methods
            AddEntity.Req addEntity = 25;

            // RelationshipType methods
            AddRelationship.Req addRelationship = 26;
            GetRelatedRoles.Req getRelatedRoles = 27;
            SetRelatedRole.Req setRelatedRole = 28;
            UnsetRelatedRole.Req unsetRelatedRole = 29;

            // AttributeType methods
            GetRegex.Req getRegex = 30;
            SetRegex.Req setRegex = 31;
            GetDataTypeOfAttributeType.Req getDataTypeOfAttributeType = 32;
            GetAttribute.Req getAttribute = 33;
            PutAttribute.Req putAttribute = 34;

            // Thing methods
            IsInferred.Req isInferred = 35;
            GetDirectType.Req getDirectType = 36;
            GetKeys.Req getKeys = 37;
            GetKeysByTypes.Req getKeysByTypes = 38;
            GetAttributesForAnyType.Req getAttributesForAnyType = 39;
            GetAttributesByTypes.Req getAttributesByTypes = 40;
            GetRelationships.Req getRelationships = 41;
            GetRelationshipsByRoles.Req getRelationshipsByRoles = 42;
            GetRolesPlayedByThing.Req getRolesPlayedByThing = 43;
            SetAttributeRelationship.Req setAttributeRelationship = 44;
            UnsetAttributeRelationship.Req unsetAttributeRelationship = 45;

            // Relationship methods
            GetRolePlayers.Req getRolePlayers = 46;
            GetRolePlayersByRoles.Req getRolePlayersByRoles = 47;
            SetRolePlayer.Req setRolePlayer = 48;
            UnsetRolePlayer.Req unsetRolePlayer = 49;

            // Attribute methods
            GetValue.Req getValue = 50;
            GetOwners.Req getOwners = 51;
            GetDataTypeOfAttribute.Req getDataTypeOfAttribute = 52;
        }
    }
    message Res {
        oneof res {
            // Concept methods
            Concept.Delete.Res delete = 1;

            // SchemaConcept methods
            IsImplicit.Res isImplicit = 2;
            GetLabel.Res getLabel = 3;
            SetLabel.Res setLabel = 4;
            GetSubConcepts.Res getSubConcepts = 5;
            GetSuperConcepts.Res getSuperConcepts = 6;
            GetDirectSuperConcept.Res getDirectSuperConcept = 7;
            SetDirectSuperConcept.Res setDirectSuperConcept = 8;

            // Rule methods
            GetWhen.Res getWhen = 9;
            GetThen.Res getThen = 10;

            // Role methods
            GetRelationshipTypesThatRelateRole.Res getRelationshipTypesThatRelateRole = 11;
            GetTypesThatPlayRole.Res getTypesThatPlayRole = 12;

            // Type methods
            IsAbstract.Res isAbstract = 13;
            SetAbstract.Res setAbstract = 14;
            GetInstances.Res getInstances = 15;
            GetAttributeTypes.Res getAttributeTypes = 16;
            GetKeyTypes.Res getKeyTypes = 17;
            GetRolesPlayedByType.Res getRolesPlayedByType = 18;
            SetAttributeType.Res setAttributeType = 19;
            UnsetAttributeType.Res unsetAttributeType = 20;
            SetKeyType.Res setKeyType = 21;
            UnsetKeyType.Res unsetKeyType = 22;
            SetRolePlayedByType.Res setRolePlayedByType = 23;
            UnsetRolePlayedByType.Res unsetRolePlayedByType = 24;

            // EntityType methods
            AddEntity.Res addEntity = 25;

            // Relationship type
            AddRelationship.Res addRelationship = 26;
            GetRelatedRoles.Res getRelatedRoles = 27;
            SetRelatedRole.Res setRelatedRole = 28;
            UnsetRelatedRole.Res unsetRelatedRole = 29;

            // Attribute type
            GetRegex.Res getRegex = 30;
            SetRegex.Res setRegex = 31;
            GetDataTypeOfAttributeType.Res getDataTypeOfAttributeType = 32;
            GetAttribute.Res getAttribute = 33;
            PutAttribute.Res putAttribute = 34;

            // Thing methods
            IsInferred.Res isInferred = 35;
            GetDirectType.Res getDirectType = 36;
            GetKeys.Res getKeys = 37;
            GetKeysByTypes.Res getKeysByTypes = 38;
            GetAttributesForAnyType.Res getAttributesForAnyType = 39;
            GetAttributesByTypes.Res getAttributesByTypes = 40;
            GetRelationships.Res getRelationships = 41;
            GetRelationshipsByRoles.Res getRelationshipsByRoles = 42;
            GetRolesPlayedByThing.Res getRolesPlayedByThing = 43;
            SetAttributeRelationship.Res setAttributeRelationship = 44;
            UnsetAttributeRelationship.Res unsetAttributeRelationship = 45;

            // Relationship methods
            GetRolePlayers.Res getRolePlayers = 46;
            GetRolePlayersByRoles.Res getRolePlayersByRoles = 47;
            SetRolePlayer.Res setRolePlayer = 48;
            UnsetRolePlayer.Res unsetRolePlayer = 49;

            // Attribute methods
            GetValue.Res getValue = 50;
            GetOwners.Res getOwners = 51;
            GetDataTypeOfAttribute.Res getDataTypeOfAttribute = 52;
        }
    }
}

message Null {} // Indicates that a request does not yield any result

message RolePlayer {
    Concept role = 1;
    Concept player = 2;
}

message AttributeValue {
    oneof value {
        string string = 1;
        bool boolean = 2;
        int32 integer = 3;
        int64 long = 4;
        float float = 5;
        double double = 6;
        int64 date = 7; // time since epoch in milliseconds
    }
}

enum DataType {
    String = 0;
    Boolean = 1;
    Integer = 2;
    Long = 3;
    Float = 4;
    Double = 5;
    Date = 6;
}

// Concept methods

message Concept {
    string id = 1;
    BaseType baseType = 2;

    message Delete {
        message Req {}
        message Res {}
    }

    enum BaseType {
        META_TYPE = 0; // This represents the top-level meta type only
        ENTITY_TYPE = 1;
        RELATIONSHIP_TYPE = 3;
        ATTRIBUTE_TYPE = 4;
        ENTITY = 5;
        RELATIONSHIP = 6;
        ATTRIBUTE = 7;
        ROLE = 8;
        RULE = 9;
    }
}

message Concepts {
    repeated Concept concepts = 1;
}

// SchemaConcept methods

message GetLabel {
    message Req {}
    message Res {
        string label = 1;
    }
}

message SetLabel {
    message Req {
        string label = 1;
    }
    message Res {}
}

message IsImplicit {
    message Req{}
    message Res{
        bool implicit = 1;
    }
}

message GetSubConcepts {
    message Req {}
    message Res {
        IteratorId iteratorId = 1;
    }
}

message GetSuperConcepts {
    message Req {}
    message Res {
        IteratorId iteratorId = 1;
    }
}

message GetDirectSuperConcept {
    message Req {}
    message Res {
        oneof res {
            Concept concept = 1;
            Null null = 2;
        }
    }
}

message SetDirectSuperConcept {
    message Req {
        Concept concept = 1;
    }
    message Res {}
}


// Rule methods

message GetWhen {
    message Req {}
    message Res {
        oneof res {
            string pattern = 1;
            Null null = 2;
        }
    }
}

message GetThen {
    message Req {}
    message Res {
        oneof res {
            string pattern = 1;
            Null null = 2;
        }
    }
}


// Role methods

message GetRelationshipTypesThatRelateRole {
    message Req {}
    message Res {
        IteratorId iteratorId = 1;
    }
}

message GetTypesThatPlayRole {
    message Req {}
    message Res {
        IteratorId iteratorId = 1;
    }
}


// Type methods

message IsAbstract {
    message Req {}
    message Res {
        bool abstract = 1;
    }
}

message SetAbstract {
    message Req {
        bool abstract = 1;
    }
    message Res {}
}

message GetInstances {
    message Req {}
    message Res {
        IteratorId iteratorId = 1;
    }
}

message GetAttributeTypes {
    message Req {}
    message Res {
        IteratorId iteratorId = 1;
    }
}

message GetKeyTypes {
    message Req {}
    message Res {
        IteratorId iteratorId = 1;
    }
}

message GetRolesPlayedByType {
    message Req {}
    message Res {
        IteratorId iteratorId = 1;
    }
}

message SetAttributeType {
    message Req {
        Concept concept = 1;
    }
    message Res {}
}

message UnsetAttributeType {
    message Req {
        Concept concept = 1;
    }
    message Res {}
}

message SetKeyType {
    message Req {
        Concept concept = 1;
    }
    message Res {}
}

message UnsetKeyType {
    message Req {
        Concept concept = 1;
    }
    message Res {}
}

message SetRolePlayedByType {
    message Req {
        Concept concept = 1;
    }
    message Res {}
}

message UnsetRolePlayedByType {
    message Req {
        Concept concept = 1;
    }
    message Res {}
}


// EntityType methods

message AddEntity {
    message Req {}
    message Res {
        Concept concept = 1;
    }
}


// RelationshipType methods

message AddRelationship {
    message Req {}
    message Res {
        Concept concept = 1;
    }
}

message GetRelatedRoles {
    message Req {}
    message Res {
        IteratorId iteratorId = 1;
    }
}

message SetRelatedRole {
    message Req {
        Concept concept = 1;
    }
    message Res {}
}

message UnsetRelatedRole {
    message Req {
        Concept concept = 1;
    }
    message Res {}
}


// AttributeType methods

message GetRegex {
    message Req {}
    message Res {
        string regex = 1;
    }
}

message SetRegex {
    message Req {
        string regex = 1;
    }
    message Res {}
}

message GetDataTypeOfAttributeType {
    message Req {}
    message Res {
        oneof res {
            DataType dataType = 1;
            Null null = 2;
        }
    }
}

message GetAttribute {
    message Req {
        AttributeValue value = 1;
    }
    message Res {
        oneof res {
            Concept concept = 1;
            Null null = 2;
        }
    }
}

message PutAttribute {
    message Req {
        AttributeValue value = 1;
    }
    message Res {
        Concept concept = 1;
    }
}


// Thing methods

message IsInferred {
    message Req {}
    message Res {
        bool inferred = 1;
    }
}

message GetDirectType {
    message Req {}
    message Res {
        Concept concept = 1;
    }
}

message GetKeys {
    message Req {}
    message Res {
        IteratorId iteratorId = 1;
    }
}

message GetKeysByTypes {
    message Req {
        Concepts concepts = 1;
    }
    message Res {
        IteratorId iteratorId = 1;
    }
}

message GetAttributesForAnyType {
    message Req {}
    message Res {
        IteratorId iteratorId = 1;
    }
}

message GetAttributesByTypes {
    message Req {
        Concepts concepts = 1;
    }
    message Res {
        IteratorId iteratorId = 1;
    }
}

message GetRelationships {
    message Req {}
    message Res {
        IteratorId iteratorId = 1;
    }
}

message GetRelationshipsByRoles {
    message Req {
        Concepts concepts = 1;
    }
    message Res {
        IteratorId iteratorId = 1;
    }
}

message GetRolesPlayedByThing {
    message Req {}
    message Res {
        IteratorId iteratorId = 1;
    }
}

message SetAttributeRelationship {
    message Req {
        Concept concept = 1;
    }
    message Res {
        Concept concept = 1;
    }
}

message UnsetAttributeRelationship {
    message Req {
        Concept concept = 1;
    }
    message Res {}
}


// Relationship methods

message GetRolePlayers {
    message Req {}
    message Res {
        IteratorId iteratorId = 1;
    }
}

message GetRolePlayersByRoles {
     message Req {
         Concepts concepts = 1;
     }
     message Res {
         IteratorId iteratorId = 1;
     }
}

message SetRolePlayer {
    message Req {
        RolePlayer rolePlayer = 1;
    }
    message Res {}
}

message UnsetRolePlayer {
    message Req {
        RolePlayer rolePlayer = 1;
    }
    message Res {}
}




// Attribute methods

message GetValue {
    message Req {}
    message Res {
        AttributeValue value = 1;
    }
}

message GetOwners {
    message Req {}
    message Res {
        IteratorId iteratorId = 1;
    }
}

message GetDataTypeOfAttribute {
    message Req {}
    message Res {
        DataType dataType = 1;
    }
}